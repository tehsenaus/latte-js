var Q = require("q");

function async(x) {
	var d = Q.defer();
	setTimeout(() => d.resolve(x), 100);
	return d.promise;
}

do {
	var x = "";
	
	for ( var i of ['a', 'b'] ) {
		console.log(x);
		x += << async(i);
	}

	console.log(x);
}
